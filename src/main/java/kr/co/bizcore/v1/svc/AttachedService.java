package kr.co.bizcore.v1.svc;

import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.HashMap;
import java.util.List;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.stereotype.Service;

import lombok.extern.slf4j.Slf4j;

@Service
@Slf4j
public class AttachedService extends Svc{

    private static final Logger logger = LoggerFactory.getLogger(AttachedService.class);
    private String defaultAvatar = "89504e470d0a1a0a0000000d49484452000000be000000bd08060000000de0c733000016a87a5458745261772070726f66696c6520747970652065786966000078daa59a6976db3ab685ff63143504e0a01f0edab5de0cdef0ebdb94e24ae35c2755f1bd964c5124709add0074e7ffffefba7ff12fb7e05dcab5955e8ae75feaa9dbe04df3af7ff3f91d7c7a7ebf0e9df767e1c7e36eeef707c6a1c86b7cfdd9ed7dfeb7e3e1e302af97c1bbfcdd85fafbee61fef8c1f876fdf6d385de378a1a916ef61e881bef0b457b7d10d27b0ae57d83c8d14f46547aab3f4c6dbd6fbdd7fbc4f69fffefb2ae43f915ab5ffe4e95a8eeac3b99b31375d3132dda6b6451ff5b1cbc767e879835a4e77de2afc167df4648a0be8dd67d3fdc8f7fedd76c7dbcfb295bf79d45f773b692bd4f893f05b97cbc7e7adc85fc79569ed07f77e7d4deefecc7e32585fc1a91ff24c877b7fb8c99598c540869794feadb149f779c47d8936edd1c432bbef27fe612f5f9e9fc340a69510adb2fea7bf2be07232b37a4b0c308379ce77585c510931d67953766cbe273b0c56add16590ae4889f70ad92b11d1bd95a643772d43ec6129edb76bfdc73b7c69d77e0540b5c2c3ce9ffcb1ff7b75fb857951bc213cbf3c48a719929d80c4399d36f4e2323e1be839a9f007ffbf9f95f789a27711651765cb913d8f9bac4cce13f48109f44474eccbcbe7a30d4fdbe0021e2d699c1844806c81a3d104af0d5ac8640201b091a0cdd62b2490642ceb619a4a5180bb969a65bf3951a9e532d1b871dc701333291638995dcd053242ba54cfdd4d4a8a191634e39e7926b6eb9e75162492597526a11288e1a6b7235d7526b6db5d7d1624b2db7d26a6badb7d1ad474033f7d26b6fbdf731b8e7e0ca836f0f4e1863da8c33cdec669975b6d9e75894cf4a2bafb2ea6aabafb16dc70d4eecb2eb6ebbef71c2a1944e3af994534f3bfd8c4ba9dde86ebaf9965b6fbbfd8e8facbdd3facbcf5f642dbcb3664fa67462fdc81a476bfd76892038c9ca19093347f39231a5808236e5ccb790922973ca192c40576463905939db41192383e904cb377ccb9db3574695b9ff296faea61ff266ff6de69c52f79799fb356f9f656d8b55d693b157172aa83ed27d7c7edab0364476bfbcba8f030c0cf0f1bb8c792c4f48a47466bfed2ca30db8f9243db1f9b5ea147faece97769f29dd66db955daeedc964661d9441f3b1d67e89e26ac99f06f8ed5ee33da7df39cf3e37ef55189c3fd71fdd8bf9843d5d69bb744ed8b7ae1a570f049da29fd55b5e37aec00512981b6e3c9c7b006acaa5b5b22dcdb9ada6d9cf39deb57ed7246737b45c884d3be90e3a7ec7dc2be07b43dc7b37cb1ba5c2484a5bbbaf156a8ca43240db7c83ba74b1af52c7a5fbcf4de76c0b6bce50227f29ee5c7f1bf3203721ae73e61864a9cc52c1a235e29e8b62b2b55d270cc17abbe32426196e0bb54c3e078500ccd94abdb7ec717326433eae4161f83973dc55e7f8f7394e27adbe533d9e0aeb7eefb3363d9109d4989551dd4ec006acb56e0d339573e2be4c6053ec9e701983bdde55eecd4cb866694c9f70ce72d0654c8cc21ce95434da68a15df2da2b395e76c7beadac3cfb2ef45c1feb1eb7c39c6bdc189516124b0f32718b378eab0658342d47ad2d4aa92b7b6639e49bd63eb585c965b97a2a8e5fdb9f450d1afcb6288bd01a03891a581cb922648846203974271596e2ced4e5a4bdaf5104e7a1e5e998aed139f59edb9f2c2d9af29299c1dce3f054ce4c3b1191b3474132988dd92eb34888ae76b91d526b48d6fcbe7ffef9750a6b76285c34814763c551a8de507b27b795124447d65a4adccd9f9136b57b080ab833e62521d4d489c4eb16508e6f85bdd20c0e7eb2c37cf723e9761c8470dc9a3722a2ceb87d4cad519cd3b74e680245ab973912e5e433054863910297248001333a9090dee937e3da4faa3d65547d2c5c033a2505b1f88dfeee641b79d316089d0fbd4a4d780754cd54798f2aa962e1b62ce500f180b48c14280ac0e4975173df1d88378de73d803627954da3daee83fea0fc03085a8b055088684a45c50eea0394fdd028ae41e8b756ab7d9fa004d08f3646a45140a19af936d1dc87d2f70d21b00ad00ba0a5a27bdf4eb79b220b66370e82797337552f220474a6ea2654478d02edf9e650053791b63fd628e0b46339041bca1bbed772b21b06a0f9c51707e443f6714bfc3723e33b835192f5d2212abab94f5db782a710204a81b365192004e86893e25507d6a41aed1cd4d1e1abd77c463edea82d2ec64fa9d9d11496fb520681e808aac50e87cfb450a42016780311df7a60cb620046ab440bc466b4b9cc38d6a29e8b399a3d05e63b35d276883a9dbff325803722b6b83b95db399c6e84ff8189c2c42aead987ad51768d935ecbcf80fd7fff8aff19693a9fa8c4d126b28081736b046087e231495427382cdd070c9dd08116755ced2367011fbcdec565ebf4769c5f6d531c4803600f075ad6f155e68db25e35d30614143114364ad873db4e7b8c70a8470fd000fa404a411f517b72c81181441eea34f484a58efea0ed88fec8096722ddb52775005d15944100d93699da495585a9a9ff90647a6345da19026096142873d1dd8078c6058132efb604883dba96c56b819aeaa02065d0264caf11b41635964402a1903e6a15486357ce79e83f9c41a1139170013847a7821cc8017e17c3b3a68244efd3134f66606b51eff1ca2d61574ad94801127f9a348b3734c42b77ee7f4d7ef8e5424d42af9d0c509114664f2544725a324ac297075ed011401a33cc275f2fe0e5dc5b136ce206ba07aebe7c1266f6681740b42042d05624dd9061d9dfd6e78a15456075875326788530ac744733942b797196021a2f986c53a785ea0c426ea80c838870dcb5522503386fb022e276af451d80e9e85fc4e0dd822974f6c4a350068f44d0e8bd5ed5c2e42f12e40e0f4cc0cc3ca446b7dd750de07a064483d36f7390cee448c0eacca22eeb85cc539be854cd8359953343909c0b9250093cf405e2f054e59884948880eee0569c8888d26cc1a21291b951634515086ee20b13f07510de42ffd7587ffbea9e3723a38fa1f6831078bc18c2658385638331a097e7bea96b005c76a9a44eed3910a145e74395a1bb819c24f89b44e6b9fad35528ad71dbf1dc28434e455cd0b3490d05882bd7049b529a6955046af6087673fdf69e68dc03846d6927242e56d18ea5d673abfbe14f29610869325fb285f2839faa2ae586dc1e038fa9b1b23a7a62226eaad6b7e257f2019ce8c0275041be02bc8fda3e2eec4aef1168357b41eef58672ef766ea1748da94c9460cbb8ad81ede50f662a17c20714e62834bd8acd8531175a0ac514660413d09755c0c87d9b828272c5173169341a1d4a884cf217614ff466c53951107e7457022ec053cf01a487230738467d2244d014d46f40ec73f9b011a186a63068684176dcad0069de20e17136c076c15c0a0a623ed2cc20cc1101a198389b9ed9e487cfb934ac2dfa414621aea85044a8d45ea33cc3421e0b68e63f169b5e67c4e8c1a1929b1417890f114e42ef86dc99b943bce426a8cafb5161a436639048f28dfd80701b4b41b090bcc411bdd752aa68334c1c120bd9fe8667f7334e676cdca26476a399dabcd1532ec8c3c6981e811ee0aa320d197e0aceb722fd3cc2db214b8823806180faa69c2b460af319cf1486f7b0e88633bf0449757f545b5006d861809db2ccb8a1ed0d0558518c672009166441e722d79bc6920af65a1a0f721159663464a998d88db57e2c392449b66831d41a60bf665954c5126af089069c6f475ce675100765dcbee001b49a438062d405bf989d29a58c8334b16980b7199eacdcd46a1d940df716390b34dc12bc835860ccf58867fc1a5982cf91ceb5ce01f6cd3c601caac5278c3121f794a8e85bae0daacc92b4bf84ea173542ac46c81311000da291745f545f521cf1748c79209f3df39dc5d6ddbb433b1c707f20cf165d1d8815c618d522f98c96f23849809800679a253458043af53847b48da704a9e3b3fff1c28c11fbec2700963b00ca986af62836c278d1eb07f5a1614346e41fa5bb8ac421943240e096430762fc58f469c5f71173493a38ee88d13b7e8d3a05ed18e246ea0225b8ee96700332632412858d82da8ffb9ef28788291fe52b67eef2def4debcd381cdc65740b17c21818eb54164d642aa8a6424f8c7716cd9d00b305b65c13191a85120e26acd694c9ab67cc533dc9e1311c177f7fcf08b841d6a866982cc46dd82b8c0085e3e8c9dfec8ea490900204c763d6cb30a6c680c7ad1fd464f8869f782f5dfb9db5fc213fd422de421bdc48cf770c7189305f81add3028ae73a7b08831e3df51a5684ee481d2b389f66a1315dae9e183d045a9df881d6e0ff7133b9f65f9496252e3914350ec597bb8fe118131544a508666c27aa9e3f7d1fd5041a738e9d69ebbe37e5a7801914fb90b4534db1fb811aaa771f143c1cd64b822112455fd884f7074249ce3885a80ed190e3fe3e132a2c96719339813627e5ce0e820d7e1934fa4df8faf355d206b69f58d1b034265637166202b07d441f667d8a9e701d3c0460b3572b31090c9a237000f61fdfe23a7952012d5170d0266b9b1e7a2c686a8fbe40a304068c0f7393a8f902214600d04e9c32db028ba1fc916492a7d870c934b008f543bb0292e580b43d543ff6d431c87c4e16f1b9078907698428a106f652062a55f7badcfb24d432492eee1564497947d4b1756d7de4f3a3403d88b57eb0b2684f56975e60e60a25b1b97e94b4c577e67d73f5ec18d8e67c473a09b0216715f8cced8393ead376bc3f8a88c73c796ac010c9953c6a36d13c74225a214001c1b43c82025ca13c9b13015f52a93f7115ee948d2e36cf078727554cb47f72351916bf41ba91f5a00ca183b484d6d09c1a0c52663f1f01c99476f746d570db88a1abe28026713b18f2302ecc90fd2102eaaf321fb8bd54b538b85809d972fba499cfe691fbb5f1a1be9077f0e381e15c14ca7323a7314f3014c0b5d77e0dbc8dc80da458960404773d450bbca29ca6ccd93d01b07c18236d7322dda09e9be83162b91df1c9d2033127d03f0a8246c8a69896e226bf0e2f1ca0ec8bd2e405a2e985bc95768c10e4af7b85aad42cbed061c75a6c7885dcd381a5c2e7ee468cb274c668269417e14c0a3300946889fc5e78d3cc27a2a9b4b35645d21de1bd8c0936141c51f124fccd97dedec32888cce2523582d722def4ac0e029da7aa3590a7ac36811e4c93d260578b48e5e900de4693e3b42345e464cd0300fe4e79c66472083a3d34a4a789fab15fec765c32c0b02b3fa34c0d4f22fa24221453524ac3c9d9687e479d512170c5e988af6c7b8348845f9782480f3872e2a022924d0e363f054b06f84c606de0cedae423a4044a6cc816cb4154d491769e14442cf9fd1a283a1c00eb4c105c9b6764b69eb5a69d44ef7677834792d6adb40363774038d972e80f7a06aae41a080367459be102c52ec110110896406a291f266d4b83caaecdeb9e8145227cbc0d5d3b473d47ae3b9dcd0a6f857ab4f15ce0e6837f86b6b5e0c2847ad5e8af775065ac3fc7488c267d793d86649c2836fc9c2650437b71d447e841429a51070b96ba1ead04621017400ae0113b7732f275d3d1e1082e7a69a09933828701c102518e4e5e1cc4d083c92b40a1e40b7315ec3a55ac831c0eaf09db858680d9d87b9ae210c7137266303af1403ba8b748149402b51d740b113238c8763b47124e75e1dca9660d13283cf07a28e6ad0124f6fe188a69f5590ef1102f11b227561e8a4686bd5d7e30a2eb513b92c5a1d57d18bb6622880677de2d0f586e1612018febeb5e043e5543ee076683b9f2eb5dcb56ed71dc4c95731c75f0a906faff8128afb4dddda39188c0eeeef865ec4f7e22e01644a07dd06311719c181c74471829fe88ea9fd9944d317d53d25f4742775279703b0617b00718f3967f800d6778d2fdfa8932218a91507b52c5616193e24a2b40d770c95d2417307adf20d2944a88c3b479f77e42bc42869916469fdca370000c78e72eacd347ae00c1f8a6916956c7fb41211a90a465aa854f4f2c4ea61434fc1c9b46d5c97b4f508232d3c0c42e4079b509412f83326473b37aeb28ceae72a0daf82979c557082b18618e51f06b6a56b75505b5f887fdd7e03ce04f748a0b6e62eee902fc935212150408465bd1c5c2166a182d734468753b5f4dc7b30d41efef56a63564d8d350478dd89420f2d1e6fda2123ab16d80ed82ced1e68b1c2da6bc58cf253fa1ad4ba424833bd9eebd1b2331de030c5e920d108be7c2fe5792b6ca21518e55d2b321d42df744445ced493e589b7fd8c13ee4f96af7f169049cbcff57182f426408b56706b2296b4442f27732f8e149ad44e1d6924db6602640638f4f8cb5aaa6f09111988a525208425d0db8e03ae30ba484dfa8d3e1b5ab2bd5408b8aca788402de80c873baa96f09356562732ba4fdcaa6f5a0e8ba46e51904756878821200f040b63dc8e56d63f6979e4349e12d509c002f5aacfda0dfcc025a14771af185350c231153a7868b310b31d90ab296d2d8e813d684269a58acd4654f6bceeef2307d4d6fbd2f7d8adb4650bb280221b605653af1437b00d87afabe78926c2a24285371d8890d2bd86dca2b249bddc1a9c50b4ecb564099349935fafa54fd46e4d7e6a8183861e02713d83c12103fa4820344391d3224cb569559c18b467397628845c7decad5d42ad3b57583eca0e2291a42f193ce1089baa94dd043406226203cd061a0124d28e161b8c1aff7605d97df681887f92784670659ea898ac41a157f1e7396adb07d90af01155adb8417b6e6b9f8c2cd3ebc48d86ceb2ab447263c2a3f4748d1315aa8a21dba21e091ae13c58c4892b673a2e3a22b60ccb0d9da2e0c9b2f66df11645fb118550507057ee1d55b09afc4784a7c1326d1ca11e3568b46a72dab3a543108ac882b322dcde8287f601c2ab1db412b5579b1e5ea462554ef913d7e37edb99887d9c70812f6f936c049f01ba392917c09d1eda0038b44652a38cdf84a33cae8312a32fefa85a96a4ea2b2c16b4623f5222da0814237c202f5d9e0d8dd0723ad53f7b4d88de4baf211b4e8a6250e8097e07d3c48df252410b68c70f6e834146a76a0b5a0b1348ec58216acd75046d15bafcec7cd462c83d347692f22d1e83da13ac9b17a86f11b94298ba28fc594107fd88b63081663ebb53ba2e19752ec5be3142e86618653d1be355045984b60056fa8bed8c0f35bc10bfa015402c0631501829a89d3d934ac3dc94a5ad477a192f8913db5731767ca667342f9c74b04f7ad6438f3d90668f26436e2449ec382233c052c1fa510f57e869892d512fb54ed88eabc0e681b3f4a417ed1b9aa44f03fea84a4299b81164d56802bea7e4364a1d9479a28d824b5ad26f9d60fb2e56a72c109a9118614eb8e051e6b4d0a36559f80421043802eb4d6b486f534e3d7db7a0f9f7db44342d00df1074bd188dcd980b2cd24e23767afa2368591bfdfbec14f688e0bc6d3375200ee4d66ec78e6d67b0d284a6731499f667536f2ee7b71e28b9153cd72a7ad1c33a27204d96f4073d8c18cde8d0992688992bb41048179524010c5dbe36a7b6c3de4d2d89faa2d5a085702240b809e01ee357492fe6b8a4e3bb87658b76b329329cb1f62ad64390bd60779c653c009d0548c82471132d2a53e3175d0d3c85827845588c452f3049d3e33bd96f6dee8d43c88fd77334432e1b736fa828e40412ebe08d0169fadc349d7283875b32df879b88b69e2a201410dcd05aad5cf756ddbad33071417494a8d5ab9596e7aff5d6e328ab4a5571685294c629dbbfcec022f11703d7f8ae5b5ac33d7a962369f78b22a3370cb565daac8636c167f0f209389def9fdebb141ba2844601a681c2b483a397bbb6b569588225f30c0107c80fd62c48c7aa87936406674db3eaf1cf89ac5a0320a20947c7594ba15517b04e3835c4f39e77e3c9b47171712e581ecc376c8df63c64233653896f0d28ad0310bf421065fe72d31308383448584f8d683160987a20cfdb2185028a57c0a43dbb2643e8fe603d4c63581893ec54996cfc1a3692b9cea272c027302e540a696ffe791c0116555f0cd90bf952e08d4ac633fc6408dcef96552ff374ff06c502e758b6f86cc30000006e7a5458745261772070726f66696c6520747970652069707463000078da3d8a310e80300c03f7bc82272471a292e79496818d81ff0bc3504796629fe5ba9f21dbaf0cc11e1e155383b7e465432d3b5fd8e1198dd9d1980b0ea5dd278a36e4c70483f0242a7404ebce1138588daabc90f81af932d9aba400000184694343504943432070726f66696c650000789c7d913d48c3401cc55f5ba52a2d1dec20ea90a13a59101571d42a14a142a8155a7530b9f40b9a3424292e8e826bc1c18fc5aa838bb3ae0eae8220f801e2e8e4a4e82225fe2f29b488f1e0b81fefee3deede01fe4685a966d738a06a96914e26846c6e5508bea217110043084bccd4e7443105cff1750f1f5fefe23ccbfbdc9f23ace44d06f804e259a61b16f106f1f4a6a573de278eb292a4109f138f197441e247aecb2ebf712e3aece7995123939e278e120bc50e963b98950c95788a38a6a81ae5fbb32e2b9cb738ab951a6bdd93bf3094d75696b94e7318492c62092204c8a8a18c0a2cc469d5483191a6fd84877fd0f18be492c9550623c702aa5021397ef03ff8ddad59989c70934209a0fbc5b63f4680e02ed0acdbf6f7b16d374f80c03370a5b5fdd50630f3497abdadc58e80c8367071ddd6e43de072071878d2254372a4004d7fa100bc9fd137e580fe5ba06fcdedadb58fd30720435da56e80834360b448d9eb1eefeee9eceddf33adfe7e000f45727f0f0234a8000010d969545874584d4c3a636f6d2e61646f62652e786d7000000000003c3f787061636b657420626567696e3d22efbbbf222069643d2257354d304d7043656869487a7265537a4e54637a6b633964223f3e0a3c783a786d706d65746120786d6c6e733a783d2261646f62653a6e733a6d6574612f2220783a786d70746b3d22584d5020436f726520342e342e302d4578697632223e0a203c7264663a52444620786d6c6e733a7264663d22687474703a2f2f7777772e77332e6f72672f313939392f30322f32322d7264662d73796e7461782d6e7323223e0a20203c7264663a4465736372697074696f6e207264663a61626f75743d22220a20202020786d6c6e733a697074634578743d22687474703a2f2f697074632e6f72672f7374642f4970746334786d704578742f323030382d30322d32392f220a20202020786d6c6e733a786d704d4d3d22687474703a2f2f6e732e61646f62652e636f6d2f7861702f312e302f6d6d2f220a20202020786d6c6e733a73744576743d22687474703a2f2f6e732e61646f62652e636f6d2f7861702f312e302f73547970652f5265736f757263654576656e7423220a20202020786d6c6e733a706c75733d22687474703a2f2f6e732e757365706c75732e6f72672f6c64662f786d702f312e302f220a20202020786d6c6e733a47494d503d22687474703a2f2f7777772e67696d702e6f72672f786d702f220a20202020786d6c6e733a64633d22687474703a2f2f7075726c2e6f72672f64632f656c656d656e74732f312e312f220a20202020786d6c6e733a746966663d22687474703a2f2f6e732e61646f62652e636f6d2f746966662f312e302f220a20202020786d6c6e733a786d703d22687474703a2f2f6e732e61646f62652e636f6d2f7861702f312e302f220a202020786d704d4d3a446f63756d656e7449443d2261646f62653a646f6369643a73746f636b3a61396438376330662d363934662d343536372d386665612d623133386436326436623935220a202020786d704d4d3a496e7374616e636549443d22786d702e6969643a66623562366634332d643962392d343535392d613962362d663861346331366364623937220a202020786d704d4d3a4f726967696e616c446f63756d656e7449443d22786d702e6469643a66306135343133662d323931302d343539322d386466362d646536363464386563336131220a20202047494d503a4150493d22322e30220a20202047494d503a506c6174666f726d3d224d6163204f53220a20202047494d503a54696d655374616d703d2231363633323032343833323136323431220a20202047494d503a56657273696f6e3d22322e31302e3232220a20202064633a466f726d61743d22696d6167652f706e67220a202020746966663a4f7269656e746174696f6e3d2231220a202020746966663a5265736f6c7574696f6e556e69743d2232220a202020746966663a585265736f6c7574696f6e3d223330302f31220a202020746966663a595265736f6c7574696f6e3d223330302f31220a202020786d703a43726561746f72546f6f6c3d2247494d5020322e3130223e0a2020203c697074634578743a4c6f636174696f6e437265617465643e0a202020203c7264663a4261672f3e0a2020203c2f697074634578743a4c6f636174696f6e437265617465643e0a2020203c697074634578743a4c6f636174696f6e53686f776e3e0a202020203c7264663a4261672f3e0a2020203c2f697074634578743a4c6f636174696f6e53686f776e3e0a2020203c697074634578743a417274776f726b4f724f626a6563743e0a202020203c7264663a4261672f3e0a2020203c2f697074634578743a417274776f726b4f724f626a6563743e0a2020203c697074634578743a526567697374727949643e0a202020203c7264663a4261672f3e0a2020203c2f697074634578743a526567697374727949643e0a2020203c786d704d4d3a486973746f72793e0a202020203c7264663a5365713e0a20202020203c7264663a6c690a20202020202073744576743a616374696f6e3d227361766564220a20202020202073744576743a6368616e6765643d222f220a20202020202073744576743a696e7374616e636549443d22786d702e6969643a61653936646139632d333532632d343730652d616334342d343763666139376232333237220a20202020202073744576743a736f6674776172654167656e743d2247696d7020322e313020284d6163204f5329220a20202020202073744576743a7768656e3d22323032322d30392d31355430393a33353a33352b30393a3030222f3e0a20202020203c7264663a6c690a20202020202073744576743a616374696f6e3d227361766564220a20202020202073744576743a6368616e6765643d222f220a20202020202073744576743a696e7374616e636549443d22786d702e6969643a38386236393165662d326365612d346366622d616365652d383465633366373663656166220a20202020202073744576743a736f6674776172654167656e743d2247696d7020322e313020284d6163204f5329220a20202020202073744576743a7768656e3d22323032322d30392d31355430393a34313a32332b30393a3030222f3e0a202020203c2f7264663a5365713e0a2020203c2f786d704d4d3a486973746f72793e0a2020203c706c75733a496d616765537570706c6965723e0a202020203c7264663a5365712f3e0a2020203c2f706c75733a496d616765537570706c6965723e0a2020203c706c75733a496d61676543726561746f723e0a202020203c7264663a5365712f3e0a2020203c2f706c75733a496d61676543726561746f723e0a2020203c706c75733a436f707972696768744f776e65723e0a202020203c7264663a5365712f3e0a2020203c2f706c75733a436f707972696768744f776e65723e0a2020203c706c75733a4c6963656e736f723e0a202020203c7264663a5365712f3e0a2020203c2f706c75733a4c6963656e736f723e0a20203c2f7264663a4465736372697074696f6e3e0a203c2f7264663a5244463e0a3c2f783a786d706d6574613e0a202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200a2020202020202020202020202020202020202020202020202020200a3c3f787061636b657420656e643d2277223f3e2e4e600f000000097048597300002e2300002e230178a53f760000000774494d4507e6090f0029179e2f3a34000020004944415478daed5d5b531b57d65d7d6fa9252424c060303703065fcac49554f29297ef2df92fc98f49fe4bf2362f79184fcd4c2a33c6061b42c040c02084eeea8b5afd3dc4fbcc51d30201c248adde552a1b1b84ce39abf759fb0e44124924914412492491845684680b6e4faad5eaa6e7790baeeb825e9ee7b117000882c05e9224b19720085b86612c46bb1801bfe7a456abfd60dbf677d56a15d56a15b55a0da669c2711cb8ae0bdbb60100cd6613cd66f31ce8d92170e0174511a22802005455852449501405baae231e8fc3300c18860155557f8cc7e3df47a71001ffd6416e9ae677a55209c56211b55a0de57219cd66936972000cb88220b46875fe4ffeeffc43407fe77fcef33cf6e0d0bf4992045114914c26118fc7914aa5303434045dd7a3872102fecde5e0e0c0ab542a383b3b43b95c866ddb2d405514e59ce626e07a9e170878bfb6f7ffacff01a09b20e8671dc769f9795555914c26313c3c8c442281c9c9c9e87c23e05f2ea552c93b3d3dc5c9c909cae5322ccb3a474578209216be2b214ac453289e4a699a86643289d1d15164b3590c0d0d45e71d01ff7f60fff0e1034e4e4e50a9549816254ad1cfc253304551904824303a3a8a7bf7ee0dfc4330908bafd56a3f1c1d1d7d77787808cbb2609a265cd785288a9065997174d2e8413cdc4f4fee42da7d16fabb288acc4668341a68369b902409baae43d3344c4c4c607c7c7c20ed8281027ea150f0f6f6f6707c7c0cdbb65b383879543ccf63ae475996fb7abd8d4683778fb67896e8c151551563636378f0e001d2e9b410013f6446eaeeee2ef2f93c3ccf83a22881da9a8c49d2f88d462350b3b733363ff9e1b5f91cf4b52ccb4ce3f3c6b6ff7b1dc7812008c864329899991908a338d40bdcdadaf28e8e8e502814a0aa2a6459866559f03c0fbaaec3719c16d7a3ebba2d066b18383e6f0893e6a78741511498a6094110a0691a1a8d066cdb463a9dc6f8f8381616168408f87d24bbbbbbdecece0eaad52af37993a1c7f3f7a040120144144566e8deb566bfee4da0280a8b335cb45e7a10c8a0a79f310c03b3b3b39899991122e0f7b07cf8f0c1dbdcdc443e9f872ccb9024e95c6a000f643ec8c47f4d2f72170681aa97a84ebbcf4260a657d05afd9489ff37d775d1683490c964b0b8b8887bf7ee0911f07b484e4f4fbdcdcd4d9c9e9e32c05b96d5f7c6692f18c79aa6b107209bcd62717111d96c5688807f8752ad5637b7b7b717f6f6f6d06c36a1aa2ad3589224b570dc48ae2efc1e0a8200dbb6218a221e3c7880f9f9f9be4ea2eb5be06f6f6f7b7ffcf1073356354d832008ec6b5555ef3cb2daef228a2273fb6a9a06cff3605916fb7a6e6e0ef3f3f34204fc4fa4e5373636160e0e0e587e0a19afbc27c675dd3b0f30f5bb789ed7b29fb4bfcd6693e52d4d4e4e627979b9efb47f5f21637777d75b5f5f677426168bc1b66d341a0de6a188e4f6843c43b22c435555d4eb754683565656facafbd3371ff49ffffca7b7bbbb0bc330983f9a38a7a2288c8f520e7cbffbe07b4548d3536d80ebba701ca7c5a6725d17d56a15333333f8e28b2f8408f85d90df7fffdddbdcdc6479ee9665b174608a4692df591445a8aa0a002c1a19c9cda80eedb56ddb2cd7877cffb4bf8ee340d3345637b0b8b888870f1f0a11f0af29af5ebdf24e4e4e587491c04ffe693e20c587e6e9fa8da43be0a7fdf4ef357f067c9599aeeb181d1dc5b367cf8408f8579052a9e4bd79f306c56231425e1f4b2a95c2e3c78f7b3205bae73e50a150f0d6d6d650a95422ad1d82db229148e0e9d3a73d97f9d9531fe6cf3ffff4fef39fffb404a122e97fc35810043c7ffe1cf7efdf1722e0fb647b7bdbdbd8d860c1a828ea1a0ea1f4114110b0bcbcdc3301af9e707c6f6d6d79ebebeb701c07f178bcefb22123b998eec4e371388e83f5f5756c6d6d7911f0016c6c6c786b6b6b902409c96412954aa5c59b10497f831e002a950a92c9242449c2dada1a363636eefc70efecdaa956ab9bbffffefbc2dede1e745d47a3d180655948241268341acc2f1f49ff0af9fd655946a55281a669906519a669e2c1830778f8f0e19da53adc59deeef6f6f6c2eeee2e344d836ddb5014058661c0344d560c1269fdfee7f7cd6613a669c2300c789ec7ce7a77771782202c0c94c6ffedb7dfbcfdfdfd730d9922192c711c07535353585d5dfde438fce45c627d7ddddbdfdf87a669d1c90fb8689a86fdfd7dacafaf7ba106febb77efbcf5f57556e81d49a4f1755dc7fafa3adebd7bf749c1ffc9ae98adad2defeddbb72d09669144c227ba3d7af4e8937576f8241a7f7f7fdf7bfbf62d9acd26745d876ddb51543612489204dbb6a1eb3a9acd26debe7d8bfdfd7d2f14c02f168bdeebd7af210802e2f1380a85020cc388a84e24701c078661a05028201e8f431004bc7efd1ac562d1eb6be0170a05efd5ab57cc90b16d9b352e8a12d022a16e753c3600e0d5ab5728140ab70afe5bf5e3bf7dfb16e57219406bc292bf7f7c2483297e1c50e3ab72b98cb76fdff6a771fbdffffed73b3c3c8c4e37926bcbf8f8389e3f7f7e2b18bd15aaf3fefd7befc3870fd1c9457223f9f0e103debf7feff50df029d33292486e6afcaeafaff78771fbf2e54b8f92932289e42642b93efff8c73fbc9e06fedede9ef7e1c307288a1205a822e98af1ab280a8e8e8eba4e79ba06fc4aa5e2bd79f38605a8a286ad91dc5464596601ae376fdea05c2e7b3d07fc8d8d0d341a8d96a92291447223707e6c27e3791e1a8d063636367a4be3efecec78fbfbfb902409b1588ccd908a24929b08b5278fc562902409fbfbfbd8d9d9f17a02f8954ac5dbdcdc642167d334079ee3d32006ff1412ff20878bfe8f1fea30c842e38a4451846118d8dcdc44a552b931b86e4cc4777777d92c295996d9c034baa20601e47e3013e0a9b536df658c9fb0e8ff19da37ea0d4add09fc83a5e9e706616f695f085bcd6613bbbbbb77abf173b99cb7bbbbcb5ac8b51bb11366af03bf6e02ad2ccb501405b66db306abfc43e27f18f8ff6b369b701c8795e8d18417fe41099a6715d6fdf5ef99288ad8dddd452e97bbd106dc48e36f6f6fc3344d64b359d4eb75341a0d6690d0dfc36e7c5d04c676eb0f1ac216f427dd9e7e0ac5ffdeb0737c5996d9806a5114118bc5707a7a8aededed4fabf1ebf5fa37c05fb3634f4e4ea0ebfac07644e093ac48dbf32f7ec222196a3ca5a13da383a524adcbdecf6f1f0c9297c7755de8ba8e9393131c1c1c783c26af44a3aefb217ef9e517af5c2e43d334d46a35e8ba7e6e6a5ed80f27c838e5ffcd711c4892044551a0aa2a144561e00da24c44711cc781ebba2dc5f841ef1f76c3d73f99919c27f1781c966521994ce2ebafbfbed6265c8beafcf1c71fdedada1aab9ce9e43a0fa350489d5e64e0132f9f989880a22888c562d0751daaaa9ed3d8fc284edbb6619a26eaf53a1cc7c1e1e121bb29e8b6f0b74b1f14c5c20b0da72e140ad8dedef6aed396f05ac0dfdbdb63dccbf33cc462311664a06b7910ca0b794f8da669482693c86432c86432300c830d95a61705f882343801da300c241209088280e9e96954ab55e4f379e4f37994cb65367b6a1006dbb9ae0b5555d9c34f4a840a992449c2dededef56e93abfec0d6d696f7eedd3b36353bec9c92a6fe516c825fb36ddbc86432181f1f472693611544ddbeede821b12c0bf97c1e474747c8e7f3acb92edd341438245084fdd6a5e9f34b4b4b572e52bfb2c6cfe572cca71a7683960ca946a3c1f28f08849aa6e1c99327d0751df1781cb22cb37950b745ab0cc380a66948a552304d13a4808822a9aaca1e8041b0b11a8d066459462e97bb5d8dbfbfbfcf1abc0e02f049bbd390b37abd0e4551f0e0c1034c4e4eb634c522cf4db77395783ac5fbf3e9c1dcdadac2f1f1714ba0471004d46a35360f2ccce7430ffad3a74f313535d5319ee52b029f197183e0bee4b5a9288a181919c1cccc0c4646469831ca1b62bce12908c28db53f019dc04fee4e7678b28c67cf9ee1e8e8083b3b3ba8542a6cc0753c1e3f17070823d521fab9bfbf7f3b1a3f9fcf7b2f5fbe64dc719052125cd7c5f8f83896979721cb324aa512734df21c9cf7d874a3989e4f71e0a90bfd490f422291806ddbd8dcdcc4d1d1510b28c27e36e4e9725d175f7df51532994c479bdeb1da3e38386839d041003df9d6979797b1baba0ad775512c16118bc5dae6e810e5e906d7a7f7e1d31bf87da787af542a31edbfb8b8c88cf2b00b8f45cff3707070d05d8d5f2a95bc5f7ffd958ddd1c94919aa228627575950dac88c7e35014059665b161c77e0dc4efc94dbd5e3c9d6c17ad251e5fafd7996bf9f4f4141b1b1ba1af7bf6074b755dc78b172f3a9ab2d891c6cfe7f34c8310e71c048effd9679f415114088280442201cbb250abd5da6a545edb7753e3fbb93dfffb6cdb46bd5e679e260048241278f6ec59e8cfc78f45dbb691cfe73bfbd94ebe696f6f8f05a31cc761aebbb0b8c32820427e61d2f4baae439665388ec3022814ad0d0aceb54b21be0987bde8fde8c02968e8ba2efbfcb1580cababab2d6ba2ce657cfa78bf6b7c3a9fab06b42e057eb158f42ccb62e008537184aaaaaca693778fadacacc0308cbe5f9f611858595961517600ac263a0cae4e3fe5765d17966575d47ef052e07ff8f001b66d9fab080a83c6f73c8f79a988a6cccdcd6164642414d35a1445c1c8c808e6e6e6185de2d71c16e396af78b36d1bc7c7c737d7f8c499c298074ef9dea429464747f1f0e1435896150ac3d0711c589685870f1f627474149665b5acb9df8577b4f059afa7a7a737037eb95cf6cae5f2b93c70f2e387c138a2686b2291c0d2d212dbd03000835217006069690989448205c2c2707e7eb73a29e74aa572692b920b577f7c7c0ccbb25adc697cd0200c1b47e9be4b4b4b300c03c56211aaaa8622b3549224a8aa8a62b108c330b0b4b4c48a5ec2707e7c6a369fda6159d6a574e742e0e772b996a8615834bd9f230e0f0f637c7c1cf57a9d3dd861b9d14849d5eb758c8f8f637878385401481e93bcb17b59e2da85a75babd558c53f7f9584296a2b0802161616584703ca71090bd569341aacf58b6559585858088d578e7048b7339fcc57ad56af07fc838303af56abb14d22edd14fc6117159411058fc81782ff1f8898909249349b689e4df0e0b95e3d7e4791e92c9242626265ace8fce948f67f443ad05b99f89aef2b953f57a9dd5e45e09f8954ae5dce1f35ff70330e84ae73d527c81b7a228c866b303d5f5cd755d64b3595658c3bba8fdc970fdf26007e1511004542a95ab6bfcb3b3b3b6e0eea78de1dd5dc477c96f9f4aa590c964020bb8c3a4f1fd0975994c06a954aaa5e303af31fbc979d10e8b8220e0ececec6ac0afd7ebdf94cbe5be0f56f1f608ef8d2283686c6c2cb0eb41588cbfa0d468bafd68edfc9ef0e7ddaf0f3e7fdee572b96deb9176c0ff896a4ddb5d2dfdba29a4ed755dc7e8e8284b3ae3811e1603deef85a3af6bb51a464747599300d2f27ee0f4e3edc67ffd3181efa78e815f2c16cf69803058ffbca4d36996b7c26f5c18eb0cfc60a6fca4542a1598eedccf0ace9faa5c2c163ba73a8542219002f4dbe6f88b66684d82202093c9b019ab7cfd70984691fa7bf8506b475a732693396707f45375dd65f81445118542a173e0930fb4dfb5a01ff8bc6b369148c0344dd6ff665080efba2e0cc380699aac7f4f98f2b0fc67ddce9f2f0619b69665b14da20df36f4abf6c103f92880ac453a914344d832449b02cab252ec1e72585c5b8a5f3237f3d5590699a86743a0dcbb2ce15b1f7831f3f088ffc5a45518465598106ee39e05b96f513256e85e1e0833a18f385e2832cd4d7d34f6bc394cef031f3f6a74b815fad5643d39622a84fa5288ad0753d1a47fa5109e8ba7e4e0984c9c06f341a81742710f861aaa90df24f53c5d5a00bed4550f7e630656f76047ccacf095bbe36aff955551d88a6ab9749b3d96425887ebe1c16e05357b94e387e68b2f7fc466a04fc56a16ec47e6f48d8b26fa9a6e442e053c4366c8be793b106a1d373a734906f844b7bc5ff19069a1bd40a460cd202740d8689e3f3071a19b6ffdb1baab7085b23011ec341d9b76d357e589e78da8076b3672339bf3f61013fade9528d5fabd57e082328fc85f27c11f6200b15e374b3d16daf2ac05aadf6435be0371a8deffcd4200c87cb6f00456fa300d6ff26be5c34653d0c1affe318a6ef2e023ec2acf1e9ef83309fab13a1596561c8c3bf4ce3fb83b26d811f36af0eaf01a89b424475feb71761f2e6f86dbc8e801fd6c5f352afd72377e647a3963a2d5fb667fdaef42e047ed8c0c05fe1fc61d66ab5d0f78eef441cc769896afaf39ac2f690b7057e98dd7cfcb567db76e8e743752234cd318cf4f6b25b2cd4ae0dbe8b001facb12c0b544c4f2fea7fdfada10ebd22b41e4551ceb57a2f97cb2c45859f6d16c6dbdf2f62103508cde23e029ef75650908606b891e6a711a6fe107e18e81e355d224f163de4a552a9a59548585b4506615bf403256c8bf5275fd1c390cfe75b343bd5a3d2ad10a60aaca0b9c4aeeb229fcfb7ec4998dd9a7e6cb77c45657a61f5e5d3f52d0802aad52af2f93c1b00c14f2d0c9bc6e7a726027f25e9e5f37954ab55b6d6b0addbcfedf912d440e087c99fcbf3541ef8342feaf0f0b06543fcfd23c3a0e5f8b957fc3a0f0f0fe1ba2ea33f7ee08781e3f358ee18f86179dafd3c9ffe4d14459c9d9da15aadb6508230a56cf0217b9ec255ab559c9d9db17df0cf8b0d6347eccb80ffa3bf4eb5df17cc77fee5d7461d940f0e0ece71fd307934fc65a4aeebe2e0e0804d0af41bfff4fd61c9cea5b5c9b2fc635be0c7e3f1efc3c6f3823c157c2b8aa3a323067ccada6c3757b61f41cfaf89d678747414b81761cdd0fc38f7e0fbb6c007fe2acb0b8bc6f76b303fe7575515954a85819f7acd8465540ef17bea2144a0af542a5055f51ca7efa7def857d1f841a34dcf019f8c9d4148dbadd7eb482412d8d9d96145f6a55209894422341a3f9148a0542ab1a2eb9d9d1d241289c01c9db0093f00fb52e093c61f84ec457eded5fafa3a6b3615368d4f4da3688d61755db6a3b91d697c4dd306a6348f8acea9d5dcfafa3a92c9644bfe4abf5ff5b66d23994c627d7d1dd41a92a6c10c82789e074dd32e077e3c1e67c19c41d108aeeb42d334bc7fff1ebbbbbb181a1a0acdf0b7a1a121eceeeee2fdfbf7d0348d951a0e82c6a7a05d3c1ebf1cf8866184cea5d74e1cc761066da552413c1ec7c6c606f2f97c28baade9ba8e7c3e8f8d8d0dc4e371542a1566e80e425a36dde6866174067cbfb33fccd7a0a228701c870d431345116b6b6b2897cb7dbfbe72b98cb5b535e6aaf4af75104496e5ce80af69dab7fc6cdb308ba6692897cb6c3410e5a7dbb68dd7af5ff7fdfa5ebf7ecdd6d36834a0eb3a9acd26cae57220ef0d2395fd78a37f7b29f063b1d8cf9aa6a1d96cb6e471d01bf16fdaef423e6e326ec9ab03fcd54af1d75f7f45b55a65039283e6c08aa2d8920ec08f96ef960dc2bfa724492d3de0f999bd34a0ba52a9e0dffffe376b9d475e1d5a23c52ac2006cffdff97cac66b3094dd3108bc57ebe14f84477880a8405e4d7914aa582b5b535eceded41d334365481680315313b8ec3daf111c8ba61231147551405b22cc3f33c388ec39a02689ac60a6b645986aeebd8dbdbc39b376f2e9dec1d662dcf633788e6004020994fa7d3383838b890070e0247a4c920efdebd43b95cc6e2e222745d47a954624315682f0894b4f917257a753a6c8d9f26efbf5de8566a369bcc0bb5b1b181c3c343f66086dd4171193e9bcd26d2e974e7c04fa55281b3a306511cc781288a383939816ddb989c9cc4f0f03080bf66091018f94cc7ab5cd197093fa69e6e011a614fda2c97cbe1e0e000c562b1e5f619748d2f080252a954e7c08fc562dfaaaafa93bfd5de20f69c245eed380e0e0f0f512e97313535856c36cb06c711ddf1e7f15fa4382e6ad01af46fe47f174511aaaa429224d4eb75e47239ecededa152a940511496933368e2df338ad8c662b16f03cfb5dd1bbd7cf9d2a39cedb0b50dbf8ab6551405f57a1daeeb42d775a651d3e934e6e6e6108bc5d85411e2dffedcfeeb1e24dfdb92ec07cff3609a26eaf53a76767650281458beb9699a8ceb371a8d817c007887c0f0f030befaea2ba1638d0f00c3c3c3c8e7f317be79d8e5e3646c16d4ab56ab0c5867676728140ac866b3989898403a9d86a228e7e6eafab551bb7df37b28fc0524e49529140a383c3cc4e9e9298b4adab60dcbb258725db95c86288a034177da61d1f33c4649af04fc442211787d84bdcf222f94dc446da6c9cd6b9a26f3839f9e9ee2f4f414894402a3a3a3181919412c160b1ca8d6ae7f0d1d9ebf4f3d25d1d56a35e472399c9c9ca052a9b0cfe6791eeaf53a8b3e53c6a5aeeba14a2dbfec560cc2a3e779482412ed1f988bdef86f7ffb9b479d85295f9d9f0ddbef1beb1f86c0c72b886610c028718df2d829dd816fb14d9ea0783c8e582c86919111a8aa0a5dd7a1aaeaa5fcbfd96cc2b66d98a609dbb691cbe550afd751abd55ada3bf29f8fe80f357fa5cf470fab3fc6c07b87fadd97cfd71b50ff20f2dfabaa8afffbbfff13aeacf1c907ea6f2a4abc310c7487fcf0bcbf9c1e726a35629a263328c9cb4300e7c14b40b42c0bb66da35c2ee3cf3fff842ccbd0340daaaa425114f6a2e0a0ebba701c87bd88b65081386fd4faf3ca6559669f876e20c771d06c3621cb728b3bd43fe8d9b6edbecfd06c87499ade7e915c08fc9191119c9c9c9c73a78585e2900b922f4f242d48fc98fce1bc8fde3f5985404540a3ffe3a3c0d4a8d65fccce97fbf19f874f99a617edbfff67fc3104fabd34dddbdf36860ce53018bf7c4d05bfa7232323d707fed8d818b6b7b7d906d2c186257b93e80aaf19c9a024cdcf3f18bcd62405c00391be97e805d1441e7c41f3a6fcfc9f1e1ea259fcbffb6b64f9b24a7fd138b93649e3f36b0dc32c635a03ed03ad4bd3348c8d8d5d1ff8c96452f8fbdfffee9d9d9d9df33a8441f313b809e0e495a18780cf6f2183953437d1223e68e5e7d17ce50f3f86c8df95981e285eebd3c1f2efc707b3e87352802d168bb1b6df74f8bcc6a7df4d3743184a4bfdad5068ff53a91492c9a4706de00340369bc5d9d9d939e32f0c5e1d32d669d308947eba373636c65c63b95c0e7ffef9270a8502a3147cf496f7c8f8a9047f1b04697cff2dcaa727f0fc95becf711ca4d369dcbf7f9f5ded676767383e3e46b95c0e7cc8f8cfd9ef54c77fc3d13ab3d9ece514e9b26f28140adebffef52ff6c674858641e3f32d4708508aa2c0300cc462314c4f4f23168b313e4c1b5babd5502e97b1bfbf0fdbb65950eb222a13e4aff77f9676de263f78154581aaaa989a9a4232996415467c94b95eafe3f0f010c56211854281a55eabaa0ac771609a66602d6a3f9e1f4f494551c4e79f7f8e743a2ddc08f800f0cb2fbf7894d3edba6e285c99a451694d922461686808232323181d1d45329984e3382d1c99a71bc05f69cd854201b95c0ea552099665b57818fc37007f603c85094a0bf1737af2d5d3674ca7d32d012adea8a69b8ca8593e9fc7f1f131f2f93c1cc781a669d0342d700c66bfba342549822ccb5055155f7ffdb570638d0f003b3b3bdebb77efd8a63a8ec33217effa89bf4c4baaaacafce3bc91c96bf0542a85a9a9298c8c8c300de27fffcbe200b66da35aada2582ca2582ca25eaf33df7f9007c81f3f08faff8fb92648a55248a552300c8369e94e0254fc5c8066b3895c2e87fdfd7d148bc5732e5272eb52bc819f777cd5dbeb53839e6e645114b1b4b484d9d9d9ee00bf542a79bffefa2b4cd3ec297e7f592c810e907ce7b66db74cbb267e3c313101455198ff9cbf113af12af040e6bd43676767cc67ce5742f13c9dc047da8a5e9224617878f85cf109eff5b9cc40e51f287a7fc771707474c4ec14be8f12fdbfe3384c615c77ef3fa5e2a3cfa2eb3a5ebc7881a1a1a1ee001f005ebd7ae5bd7fffbea7f23f2eca70e41f4c7ee083699a482412989b9b432693612e43aa56a2e28e4e66e1fa7fbf7fba2251421eacfeb405fe67f88788b45950aac345ebf6039fdac598a6796e7df97c1e7ffcf1072a950a4b73f07756be686f7b85ee92d13f3d3d8d67cf9e7584e98e513c393989bdbd3df68be8fabc6b3fee45572e1fd62737defcfc3c1e3c78c08049914e021dd11c4a47e844e3b4cbc1e167c8fa69833f818d40c77f7d539723df4d81a8293dd08aa2209bcd2293c9606f6f0fbbbbbb00c068c345ebbf6cdf3fa5e223278b2008989c9cecfc67aff28b5ebe7ce9e5f3f99e316ef9455fc4fbc9edb7b0b080542ac5a68310af25c39112d0c836e804f87e40fbfdf697d926973db8eddeb713ba499a5d1004e8bacee212bc7f9fd21b8ac522b6b6b6989bf6223edf4be382e866cc64326d53906f0cfcfdfd7d6f6d6d8d6992bb9e0eee0ffffb8d44d2f893939378f8f021e3f1442be826204dcbfbf53bb9cdfcc1938b684cd09f97dd1ced2814afed3af98c64d390778a5216e8b6a3fa5dc771f0fbefbfe3e0e0a025018fa762fc5aef5ae3d343ebba2e9e3e7d8aa9a9a9db013e69fd62b1d83321ef208f03cf9597969630363606dbb6d9154eff6759163324c9e0e473e1af6364f12f0266505a42d01a82e810ffb3d72905f5b749a7b5dab6cdf83f19e492244155551c1f1f83bc787cf4d8efe1e9851b9fdcd057d1f657e2f824d96c16bd447782b4237949565757cf0d75e393bac873c1b7e9b8cea1b61ba1e37f3f7fca41d04dc1ff6edec3749d292d7eaac2af953c38b22cb7ec4da3d1403a9dc6e79f7f8edf7efbadc5c0eeb5d80dd9689725a405de8457fd81c5c545219148b4f8baf9a42e32aaba110e272eca87eefdc11f3e3989be2f9d4ee3cb2fbf0ccc45e7833c7ce259b7aeed20ce1f6487f8bd3c41dfd7ce7eb8ce03e98f11f07be0df1b521e5f7ef925d2e934fb9a77a3fab34579a5c363e1a6e7cfa76f1316e8f7351a0d2412092c2c2c08b70e7c0078f0e0013310a9e8999e40ff07be8990c1495c940e8eb414e5cd93efdb344d4c4e4ee2c58b17cc7d17c9f5c5344dbc78f1029393932cc54155d5966837e5fdf34973e446bda9f00a94b0451567f4703d78f0e05aef7d2de0cfcdcd09e9749a650676a26d6ee29fa585f3da9b77d391e1f6e4c9132c2d2da1542a21168b45c8bda1c46231944a252c2d2de1c993276c9f0984bc71cc0f580b4af6ebc68dc51bec8ee320954a616e6e4ef824c0afd7ebdf903f9c023f8661b480b45b571d752cf06f68101f5f5e5ec6f4f4344cd36cb98522b9be9076354d13d3d3d3585e5e0e34e683145437ca1a89def0676f1806eb66373f3fdf82c95b053ef5219c9c9c1446474719d06e2398c5b7e920ed422e47ba060541c0eaea2ac6c7c751a954d8f7dfb5ab350cc2ef65a552c1f8f8552751250000085a4944415438565757999b983f0bba85f9ce10b7e5c5314d13a3a3a3989c9c14784cde3ad521999f9f87aeebacf8813c3d7cc3d99b521d325ea9948f8232966521168b6175751589448285da2dcb6ac96d89e4fa42361c3517206372757515b1588cd51753aa349d7db7e6e4d203457d85a8d046d775a6edafbdb69bfcf0c8c8883033331358f3d88d279ebf45c8a86d341a68341a300c034f9f3e6506165db7baae87665ce75d0bb93f694f09809224e1e9d3a7300c839d0719b9416777931bdf1f406b369b989999c1c8c8887067c0078099999996ee04d7090075b2783a8446a381783c8eb9b939249349689ac6b246c9d08db47d77b53e19b494e4a7691a92c924e6e6e6108fc75b324ebb19d1e5ed39be3c746666e6e6ebbae91b24120961717111d56a9555f9746bcc0c158a50899f6ddb906519333333989c9c6c69bde10f040d72a3db6eda58fee01aed35a582cccccc40966556d4425323bb417529cf4a5555b8ae8b5aad86478f1e21914808770e7c00989d9d15a6a6a6e0ba2eeaf53abb0ebb71d5aaaaca004f7605a5204472b762db36c6c6c618dfa607e0b25cfeab687cbac50160626202d3d3d35dd1685de304cbcbcbec3ae4f33b6eaaf1ebf53a144581699ab877ef1ea6a6a658602b92bbb701344dc3d4d414eeddbb07d3345993dd6e283ee2f4e4d67ef2e449f7285cb7de28994c0a8f1f3f6611be6ef871f9828ca1a121cccfcfb3e4b288caf40615a2b3989f9fc7d0d0100369b79c1baaaaa25eafe3f1e3c75da1385d073e004c4f4f0be3e3e3ac57fc4d85fa22369b4d3c7efc98052f22e3b5b78c5f0a623e7efc98dd02dd507ce4319a9a9ac2cccc4c57355dd711f4e5975f0add8adc0a82806ab58ac5c5450c0d0db1feef83daafbfd7844f55304d13434343204747b734be2008f8e28b2fba7ebddf8aea5c5959e94a4352511431343484d9d9595628ce476c23b97baac37728b66d1bb3b3b3181a1aeacaad1c8bc5589a445f007f7a7a5ab877ef5e57aebae7cf9f33bb817ac10cca1cde7e00be2449aca88532649f3f7fde15aa93c964ba4e716e15f800f0fcf973219d4e330f8fbf30d89fc7cd6f26817e6565050058591cb9caa8602292bb154a4d27973335aba25b9fefe9ef3f5f0a4af278e03d82e9741a9f7df6d9ad69b75bb5121f3d7a846432d9d2b8888fc6d1df690369f1b66d239bcd22954ab5e464f31b1325a1ddbdf0c5297caf7a4992904aa590cd66592e0fa5b590d7c78f037a3f5114914c26f1e8d1a3db35ca6ff3cdd3e9b4f0ecd9330060f5adfc34155a344503a9944c55554c4c4cc0308c96a9dd411b1dc9dd521d7ff51b9d956118989898682971e4cf9ace9e120b091b00f0ecd9b34b7b5ff634f00120954a094f9e3c81e779a8d56a48a7d3a856ab2d13c0293a47c01f1f1f47269361f91ffe3622419d8523f9f412d4d582cecb755d643219907b9b3f637e024db55a453a9d46ad5683e77978f2e40952a9d4ad6bb54fe2109f9a9a121e3d7a04511499a1ca17ad10b05dd785a669aca51f5d8ba425f8f2c3487a43fc8329e86bcab19a989860bdfa79ca43b4880c625114f1e8d1a32bb508e979e003c0c2c282b0b8b8884aa5c232fe6813281787723fa8989de80d511cfe6189c0df1ba0f7b759a7f32245964824586e159d313f81461445542a152c2e2e5eab68bce7810f004b4b4bc2caca0acbe9e0fbc750def7fdfbf7cf4d5c6937372a92bb95a0c92efcd77486f7efdf6739fd7c8b15cac15a5959c1d2d2d22735da3eb9da5c595911a6a6a658ea0101deb22c249349a452a996464cfccdc077398b80df1bc0a7b30a9a254667f571340f2ccb6a79002ccbc2d4d4145656563eb9a7e24ef8c2eaeaaa30333303cbb2582b425996313b3bdb52b8ccf79509d22e91dcbd5727687a635011faecec2c7b38282633333383d5d5d53b39c83b23caf3f3f35bb3b3b3d0340db95c0ed96c96717bcaca8ba4bf85f2f21b8d0692c924b2d92c72b91c344dc3ecec2ce6e7e7b7eeeab3dd59b37bc33016ebf5fa37b22cffb4b5b585f1f171e6d30dc360b248d0e2add3751d131313c8e572d4aae44eafec9ee00b5b5b5bded8d818bb1ec9c5d54b432822b9ba341a0de8bacea2b79ee7e1f8f8f8937a6f7a1af824a552c99324a9ab553c91dc9db8ae8b582cc6326b3b19d13390c007804aa5e28561ea7624ad74e7b281cb0363dcb6936e96974572c75a5510b600f41ce87b12f8003034342488a2f863049dbe07fecfbd446f7a9aeaf8a556abfdd06c36bfe3f340f85675174914e4ba31702fa531fe33f9984bf5633c1effbea7d7d60f0750afd7bf715df7273e4b931fb51305b33eadf0135ef869291fa3ebdf5ea7896b04fc2b80bf5dc7b4ebcc8a8a0457da473ea7bedf40df57c0e7a98febbadf05b5026f372d3092ee00dfbf9f5c066dcf539bbe073e69ff46a3f15304ecbb7f306459ee1b2ddff7c027a9542a9edf880db20122b99ef839bcdfe8ed67d7735f47891289849048240449927ef46709461e9dee68747f56ac24493fd2bef7f3da42c31578b767c4ef6f87e7f7839b72e080efe7ff9db420f17b85c2dc9ad0bfb64e660850c148bff2f88102fe556c00ff3009bf07a3df1f02ff6007fffaf83d081b870f35c7efc4069024e95b5114b7fc93c5db01c17fc58781a6f8d7d7ae76f9239dd99224e9dbb0e74c0d1411e6ed007f995c9071dcef76827f8dfef5f1ff1f26fe1e01ff8207c0f3bc6f9acde64290211c1603b9dd3ab894832d41107e1e24c00f34f07943f8e303f01deff30f5331bb9fce7cec85f3a320083f87cd608d807fcd87a0d96cfee003cd429f1bb72dc5dca2287e3fc8608f80dfa12d100aefc58071f708f8b7701b349bcd858bfafb04794d2ed0c6977ecf65e2ef3f248ae256a4d523e0dfba54abd54d9e12f97de6372d96a7a6b9fe878c288c61188bd12944c0efa91be2a346fe8937323be4e52d34e5e3bffd1c69f148228924924822892492483a94ff0777c2694fd8a932100000000049454e44ae426082";

    // 첨부파일의 요청에 대한 응담을 처리하는 메서드
    public byte[] getAttachedFileData(String compId, String funcName, int funcNo, String fileName){
        byte[] result = null;
        String sql = "";
        Connection conn = null;
        PreparedStatement pstmt = null;
        ResultSet rs = null;
        FileInputStream fis = null;
        String rootPath = null, path = null, savedName = null, s = File.separator;
        File file = null;

        rootPath = fileStoragePath + s + compId;
        savedName = systemMapper.getAttachedFileName(compId, funcName, funcNo, fileName);
        if(savedName == null)   return result;

        path = rootPath + s + funcName + s + funcNo + s + savedName;
        file = new File(path);
        if(!file.exists())  return result;

            try {
                fis = new FileInputStream(file);
                result = fis.readAllBytes();
                fis.close();
            } catch (Exception e) {e.printStackTrace();}

        return result;
    }

    public byte[] getUserImage(String compId, String userNo){
        byte[] result = null;
        FileInputStream fis = null;
        String path = null, savedName = null, s = File.separator;
        File file = null;

        path = fileStoragePath + s + compId + s + "userPicture" + s + userNo;
        file = new File(path);
        if(!file.exists()){
            try {
                fis = new FileInputStream(file);
                result = fis.readAllBytes();
                fis.close();
            } catch (Exception e) {e.printStackTrace();}
        }else{
            result = hexToByteArray(defaultAvatar);
        }

        return result;
    }

    public boolean saveAttachedFileToTemp(String compId, String savedName, byte[] fileData) {
        boolean result = false;
        FileOutputStream fos = null;
        String path = null, s = File.separator;
        File file = null;

        path = fileStoragePath + s + compId + s + "temp" + s + savedName;
        file = new File(path);

        try{
            fos = new FileOutputStream(file);
            fos.write(fileData);
            result = true;
        }catch(IOException e){e.printStackTrace();}

        return result;
    }

    // 업로드된 파일을 저장하는 메서드. 동일 파일명이 존재하는 경우 기 존재 파일을 삭제처리 후 저장하도록 함
    public boolean saveAttachedFile(String compId, String fileName, String savedName, byte[] fileData, String funcName, int funcNo) {
        boolean result = false;
        FileOutputStream fos = null;
        String path = null, s = File.separator, existName = null;
        File file = null;
        int v = 0;

        existName = systemMapper.getAttachedFileName(compId, funcName, funcNo, fileName);
        if(existName != null){
            path = fileStoragePath + s + compId + s + funcName + s + funcNo + s + existName;
            file = new File(path);
            if(file.exists())   file.delete();
            systemMapper.deleteAttachedFile(compId, funcName, funcNo, fileName);
        }

        try{
            path = fileStoragePath + s + compId + s + funcName + s + funcNo;
            file = new File(path);
            if(!file.exists())  file.mkdirs();
            file = new File(path + s + savedName);
            fos = new FileOutputStream(file);
            v = systemMapper.setAttachedFileData(compId, funcName, funcNo, fileName, savedName, fileData.length);
            if(v > 0){
                fos.write(fileData);
                fos.close();
                result = v > 0;
            }
        }catch(IOException e){e.printStackTrace();}

        return result;
    }

    // 업로드된 파일을 임시 저장하는 메서드. 전자결재와 자료실 등 본문이 저장되기 전 파일이 먼저 업로드되는 경우 사용
    public String saveAttachedToTemp(String compId, byte[] fileData) {
        FileOutputStream fos = null;
        String path = null, s = File.separator, savedName = null;
        File file = null;
        int v = 0;

        while(true){
            savedName = createRandomFileName();
            path = fileStoragePath + s + compId + s + "temp" + s + savedName;
            file = new File(path);
            if(!file.exists())  break;
        }

        try{
            fos = new FileOutputStream(file);
            fos.write(fileData);
            fos.close();
        }catch(IOException e){e.printStackTrace();}

        return savedName;
    }

    // 개인정보 수정에서 업로드된 파일을 임시 저장하는 메서드. 이름은 확장자 없이 사번으로 저장.
    public boolean saveMyImageToTemp(String compId, String userNo, byte[] imageData) {
        FileOutputStream fos = null;
        String path = null, s = File.separator;
        File file = null;
        int v = 0;

        path = fileStoragePath + s + compId + s + "temp" + s + userNo;
        file = new File(path);
        if(!file.exists())  file.delete();

        try{
            fos = new FileOutputStream(file);
            fos.write(imageData);
            fos.close();
        }catch(IOException e){e.printStackTrace();return false;}

        return true;
    }

    public int deleteAttachedFile(String compId, String funcName, int no, String fileName) {
        String rootPath = null, path = null, savedName = null, s = File.separator;
        File file = null;

        rootPath = fileStoragePath + s + compId;
        savedName = systemMapper.getAttachedFileName(compId, funcName, no, fileName);

        path = rootPath + s + funcName + s + no + s + savedName;
        file = new File(path);
        if(!file.exists())      return -2;
        else if(file.delete()){
            systemMapper.deleteAttachedFile(compId, funcName, no, fileName);
            return 0;
        }else                    return -1;
    }

    public String getAttachedFileList(String compId, String funcName, int funcNo) {
        String result = "[";
        List<HashMap<String, String>> list = null;
        HashMap<String, String> each = null;
        int x = 0;

        list = systemMapper.getAttachedFileList(compId, funcName, funcNo);
        for(x = 0 ; x < list.size() ; x++){
            each = list.get(x);
            if(x > 0)   result += ",";
            result += ("{\"fileName\":\"" + each.get("fileName") + "\",");
            result += ("\"size\":" + each.get("size") + ",");
            result += ("\"removed\":" + !each.get("removed").equals("0") + "}");
        }
        result += "]";

        return result;
    }
    
}
