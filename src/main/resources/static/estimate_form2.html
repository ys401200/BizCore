<div class="estimate_wrap">
    <div class="imgLogo"><img src="images/estimate/pdf_logo_left.jpeg" class="logoLeft" /><img src="images/estimate/pdf_logo_right.png" class="logoRight" /></div>
    <div class="estimate_title">QUOTATION</div>
    <div class="estimate_header">
        <div><div><div><span>견</span><span>적</span><span>일</span><span>자</span></div></div><div class="estimate_date">2022-10-07</div><div><div><span>상</span><span>호</span></div></div><div class="company_name">주식회사 비전테크(부산)</div></div>
        <div><div><div><span>견</span><span>적</span><span>번</span><span>호</span></div></div><div class="estimate_no">VTEK202210_628</div><div><div><span>대</span><span>표</span><span>이</span><span>사</span></div></div><div class="company_ceo">이 승 우 (직인생략)</div></div>
        <div><div><div><span>사</span><span>업</span><span>명</span></div></div><div class="estimate_project">[2022년12월 05일 ~ 2024년 11월 30일 ] 한국산업기술평가관리원 유지보수 견적서</div><div><div><span>주</span><span>소</span></div></div><div class="company_address;">부산시 해운대구 센텀중앙로 97 센텀스카이비즈 A동 2509호</div></div>
        <div><div><div><span>수</span><span>신</span></div></div><div class="estimate_receiver">KCC 정보통신/담당자</div><div class="company_contact"><div><span>전</span><span>화</span><span>/</span><span>팩</span><span>스</span></div></div><div>070-8260-3882 / 051-955-3723</div></div>
        <div><div><div><span>영</span><span>업</span><span>담</span><span>당</span></div></div><div class="estimate_sender">조용희</div></div>
    </div>
    <div class="estimate_summary"><div><div><div><span>견</span><span>적</span><span>금</span><span>액</span></div></div><div class="estimate_total_amount">￦&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;12,000,000&ensp;&ensp;(VAT 포함)</div><div><div><span>유</span><span>효</span><span>기</span><span>간</span></div></div><div class="estiomate_expiration_period">견적일로 부터 4주</div></div></div>
    <div class="estimate_content">
        <div><div>No.</div><div>구분</div><div>품 명 / 규 격</div><div>수량</div><div>소비자가</div><div>공급 단가</div><div>합계</div><div>비고</div></div>
        <div>
            <div>1</div>
            <div>2023년 유지보수</div>
            <div><span>D-Station</span>
                <p>품명 : Dstation 150 User</p>
                <p>- 제품 S/W 업데이트 지원(Ver. X.Y.Z에서 Y.Z 지원)</p>
                <p>- 일상 지원 : 전화/E-Mail/Online 지원</p>
                <p>- 장애처리 : 장애 시 방문 또는 Online 지원</p>
                <p>- 정기점검 : 반기 방문 점검(5월,11월)&nbsp; 후 보고서 제출&nbsp;</p></div>
            <div>1</div>
            <div></div>
            <div>5,454,545</div>
            <div>5,454,545</div>
            <div></div>
        </div>
        <div>
            <div>2</div>
            <div>2024년 유지보수</div>
            <div><span>D-Station</span>
                <p>품명 : Dstation 150 User</p>
                <p>- 제품 S/W 업데이트 지원(Ver. X.Y.Z에서 Y.Z 지원)</p>
                <p>- 일상 지원 : 전화/E-Mail/Online 지원</p>
                <p>- 장애처리 : 장애 시 방문 또는 Online 지원</p>
                <p>- 정기점검 : 반기 방문 점검(5월,11월)&nbsp; 후 보고서 제출&nbsp;</p></div>
            <div>1</div>
            <div></div>
            <div>5,454,545</div>
            <div>5,454,545</div>
            <div></div>
        </div>
        <div>
            <div style="grid-column-start: 1;grid-column-end: 7;font-weight: bold;">공&ensp;급&ensp;가&ensp;합&ensp;계</div>
            <div style="justify-content: right;">10,909,090</div>
            <div></div>
        </div>
        <div>
            <div style="grid-column-start: 1;grid-column-end: 7;font-weight: bold;">부&ensp;가&ensp;가&ensp;치&ensp;세</div>
            <div style="justify-content: right;">1,090,910</div>
            <div></div>
        </div>
        <div>
            <div style="grid-column-start: 1;grid-column-end: 7;font-weight: bold;">총&ensp;&ensp;&ensp;&ensp;금&ensp;&ensp;&ensp;&ensp;액</div>
            <div style="justify-content: right;">12,000,000</div>
            <div></div>
        </div>
    </div>
    <div class="estimate_remark"><h3>Remarks<span><p>기간 :&nbsp; 2022년12월 05일 ~ 2024년 11월 30일&nbsp;</p><p>결제조건은 검수(납품) 당월 계산서 발행, 익월 결제 입니다.<br />납기기간은 발주 후 최대 4주 입니다.<br />설치비용 포함 견적이며 고객사 응용프로그램 사용에 따른 커스터 마이징 비용은 미 포함이며 협의 후 포함합니다.</p></span></h3></div>
    <div class="estimate_footer"><img src="images/estimate/pdf_bottom.png" class="estimate_bottom_img" /></div>
</div><!-- <div style="width:100%;"><button type="button" onclick="solPdf();" style="border: 0; background-color: #4680ff; color: #fff; text-align:center; width: 30%; height:44px; cursor: pointer;">PDF파일 저장</button></div> -->

<style>
    @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300&family=Outfit:wght@600&display=swap');
    @font-face {font-family:MalgunGothic; src:url(${path}/form/fonts/malgun.ttf);}
    .estimate_wrap{font-family:MalgunGothic, sans-serif;font-weight:0;overflow: hidden;font-size: 10px;}
    th, td{padding:1px 1px 4px 2px;}
    .imgLogo .logoLeft{margin-top: 10px;width:28%;height:auto;}
    .imgLogo .logoRight{width:70%;height:auto;position:absolute; top:13px;right: 0;}
    .estimate_title{font-family: 'Outfit', sans-serif;font-size: 40px;text-align:center;padding-top: 30px;padding-bottom: 20px;}
    .estimate_header{font-size:10px;font-weight: bold;border: 2px solid #000;padding:0.5em 3em; margin:0.5em 0 1em;}
    .estimate_header > div{display:grid;grid-template-columns: 1fr 7fr 1fr 7fr;padding:0.2em 0;}
    .estimate_header > div > div:nth-child(odd) > div{width:calc(100% - 1.5em);display: inline-flex;flex-flow:row nowrap;justify-content: space-between;}
    .estimate_header > div > div:nth-child(even){text-align: left;}
    .estimate_header > div > div:nth-child(odd)::after{content:':';padding:0 0.5em;margin:0;}

    .estimate_summary{font-size:10px;font-weight: bold;border: 2px solid #000;padding:1em 3em; margin:0.5em 0 1em;}
    .estimate_summary > div{display:grid;grid-template-columns: 1fr 7fr 1fr 7fr;padding:0.2em 0;}
    .estimate_summary > div > div:nth-child(odd) > div{width:calc(100% - 1.5em);display: inline-flex;flex-flow:row nowrap;justify-content: space-between;}
    .estimate_summary > div > div:nth-child(even){text-align: left;}
    .estimate_summary > div > div:nth-child(odd)::after{content:':';padding:0 0.5em;margin:0;}

    .estimate_content{font-size:10px;border: 2px solid #000;margin:0.5em 0 1em;}
    .estimate_content > div{display: grid;grid-template-columns: 4fr 11fr 64fr 6fr 8fr 8fr 8fr 7fr;border-top:1px solid black;}
    .estimate_content > div > div{border-right:1px solid black;padding:0.3em;display:flex;align-items: center;justify-content: center;}
    .estimate_content > div > div:nth-child(3){text-align: left;display:block;}
    .estimate_content > div > div:nth-child(8){justify-content: left;}
    .estimate_content > div > div:nth-child(8){border-right:none;}
    .estimate_content > div > div:nth-child(5),
    .estimate_content > div > div:nth-child(6),
    .estimate_content > div > div:nth-child(7){justify-content: right;}
    .estimate_content > div:nth-child(1){background-color: #990B19;border-top:none;}
    .estimate_content > div:nth-child(1) > div{display: block;color:white;font-weight: bold;text-align:center;}

    
    .estimate_remark{font-size: 10px;margin-bottom: 20px;}
    .estimate_remark h3 span{font-size: 10px;padding: 0 10px;}
    .estimate_footer img{width:60%;float:right;}
</style>


<script type="text/javascript" src="/js/jquery.min.js"></script>
<script>
function solPdf(){ 
    let nowDate, element, date, estTitle, estDate, dateYear, dateMonth, dateDay, now, year, month;
    
    
    estTitle = "[2022년12월 05일 ~ 2024년 11월 30일 ] 한국산업기술평가관리원 유지보수 견적서";
	estDate = "2022-10-07";	
	dateYear = estDate.substring(2,4);
	dateMonth = estDate.substring(5,7);
	dateDay = estDate.substring(9,11);	
	now = new Date();
	year = now.getFullYear();
	month = parseInt(now.getMonth())+1;
	
	if(month < 10) month = "0" + month;
	else month = month;
	
	if(now.getDate() < 10) date = "0" + now.getDate();
	else date = now.getDate();
	
	nowDate = year + "-" + month + "-" + date;
	element = document.getElementById("mainPdf");
	
	html2pdf().from(element).set({
	  margin: 5,
      filename: dateYear + dateMonth + dateMonth + "_" + estTitle + '.pdf',
      html2canvas: { scale: 10 },
      jsPDF: {orientation: 'portrait', unit: 'mm', format: 'a4', compressPDF: true}
	}).save();
}

function romanize(num) {
    let digits, key, roman, i;
    if (isNaN(num)) return NaN;
    digits = String(+num).split("");
    key = ["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];
    roman = "";
    i = 3;
    while (i--) roman = (key[+digits.pop() + (i * 10)] || "") + roman;
    return Array(+digits.join("") + 1).join("M") + roman;
}

$(document).ready(function(){
	let temp, dataTemp, specTd;
    temp = [];
	dataTemp = {};
	specTd = $("#mainTable tbody #mainTr #specTd");
	
	specTd.each(function(index, item){
		$(item).html($(item).html().replaceAll("<p>", "<br>").replaceAll("</p>", ""));
		console.log($(item).html());
	});
	
	if($("#mainTable tbody tr").find("#titleNumber")){
		$("#mainTable tbody tr").find("#titleNumber").each(function(index, item){
			$(this).html(romanize($(this).attr("data-number")));
		});
	}
	
	if($("#mainTable tbody tr").find(".noTitleTd")){
		$("#mainTable tbody tr").find(".noTitleTd").each(function(index, item){
			var rows = $(".noTitleTd:contains('" + $(this).text() + "')");
	        if (rows.length > 1) {
	            rows.eq(0).attr("rowspan", rows.length);
	            rows.not(":eq(0)").remove();
	        }
		});
	}
});
</script>